<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Raphaël · Growing Pie</title>
        <link rel="stylesheet" href="demo.css" media="screen">
        <link rel="stylesheet" href="demo-print.css" media="print">
        <style media="screen">
            #holder {
                height: 400px;
                margin: -200px 0 0 -200px;
                width: 400px;
            }
        </style>
        <script src="raphael.js"></script>
        <script type="text/javascript">

            window.onload = function () {
               
                //CREATING RAPHAEL OBJECT & LOGIC FOR CUSTOM SEGMENT CREATING PATH FOR PIE SLICE
                var r = Raphael("holder");

                r.customAttributes.segment = function (x, y, r, a1, a2, color) {
                    var flag = (a2 - a1) > 180,
                    a1 = (a1 % 360) * Math.PI / 180;
                    a2 = (a2 % 360) * Math.PI / 180;
                    return {
                        path: [["M", x, y], ["l", r * Math.cos(a1), r * Math.sin(a1)], ["A", r, r, 0, +flag, 1, x + r * Math.cos(a2), y + r * Math.sin(a2)], ["z"]],
                        fill: "#" + color
                    };
                };
                //ANIMATING/EXTENDING THE RADIUS TO MAKE CONSUMED VALUES VILISBLE
                function animate(ms) {
                    var start = 0,
                        val;
                    for (i = 0; i < ii; i++) {
                        val = 360 / total * newDataSet[i].value;
                        paths[i].animate({segment: [200, 200, 150, start, start += val, newDataSet[i].color ]}, ms, "bounce");
                    }
                }

                //PARSING THROUGH DATA
                var data = [{mood: ":)"}, {mood: ":|"}, {mood: ":("}, {mood: ":("}, {mood: ":("}, {mood: ":)"}]

                    var happy = {
                        "mood": ":)",
                        "color": "df60b6",
                        "value": 0,
                        "content": [] 
                    }

                    var indifferent = {
                        "mood": ":|",
                        "color": "f2f3dc",
                        "value": 0,
                        "content": [] 
                    }

                    var sad = {
                        "mood": ":)",
                        "color": "407cc9",
                        "value": 0,
                        "content": [] 
                    }

                //FOR EACH ENTRY, PUT DATA INTO DESIGNATED MOOD HASH AND +=1 VALUE FOR EACH CORRESPONDING ENTRY
                for (var i = 0, ii = data.length; i < ii; i++){
                    if (data[i].mood == ":)"){
                        happy.value += 1
                        happy.content.push(data[i])
                    }else if (data[i].mood == ":|"){
                        indifferent.value += 1
                        indifferent.content.push(data[i])
                    }else if (data[i].mood == ":("){
                        sad.value += 1
                        sad.content.push(data[i])
                    }
                }

                console.log(happy, indifferent, sad)

                var newDataSet = []
                    newDataSet.push(happy)
                    newDataSet.push(indifferent)
                    newDataSet.push(sad)

                console.log(newDataSet.length)

                // var data = [2, 5, 20, 1, 3],
                var paths = r.set(),
                    total,
                    start;

                //ITERATING THROUGH DATA INTO PATH SEGMENTS ON RAPHAEL OBJECT -- 1 RADIUS SO PIE SLICE IS NOT VISIBLE UNTIL ANIMATE FUNCTION CALLED
                total = 0;
                for (var i = 0, ii = newDataSet.length; i < ii; i++) {
                    total += newDataSet[i].value;
                }
                start = 0;
                for (i = 0; i < ii; i++) {
                    var val = 360 / total * newDataSet[i].value;
                    (function (i, val) {
                        paths.push(r.path().attr({segment: [200, 200, 1, start, start + val, newDataSet[i].color], stroke: "#fff"}));
                    })(i, val);
                    start += val;
                }
                animate(1000);
                // var t = r.text(200, 20, "Click on segments to make them bigger.").attr({font: '100 20px "Helvetica Neue", Helvetica, "Arial Unicode MS", Arial, sans-serif', fill: "#fff"});
            };
        </script>
    </head>
    <body>
        <div id="holder"></div>
        <p id="copy">Demo of <a href="http://raphaeljs.com/">Raphaël</a>—JavaScript Vector Library</p>
    </body>
</html>